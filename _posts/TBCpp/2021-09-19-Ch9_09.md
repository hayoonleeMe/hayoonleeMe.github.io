---
title: "C++ Chapter9_09 ë³µì‚¬ ìƒì„±ì, ë³µì‚¬ ì´ˆê¸°í™”, RVO Return Value Optimization"
excerpt: "ë³µì‚¬ ìƒì„±ì, ë³µì‚¬ ì´ˆê¸°í™”, RVO Return Value Optimization"
categories:
  - Cpp
tags:
  - Cpp
last_modified_at: 2021-09-19
toc: true
toc_sticky: true
toc_label: "ëª©ì°¨ğŸ‘€"
---

<pre>ë³¸ í•„ê¸°ëŠ” ì¸í”„ëŸ°ì˜ í™ì •ëª¨ êµìˆ˜ë‹˜ì˜ ê°•ì˜ì¸ <b>í™ì •ëª¨ì˜ ë”°ë¼í•˜ë©° ë°°ìš°ëŠ” C++</b> ë¥¼ ë“£ê³  ì‘ì„±í•©ë‹ˆë‹¤.</pre>{: .notice--success}

### [ë³µì‚¬ ìƒì„±ì, ë³µì‚¬ ì´ˆê¸°í™”, RVO Return Value Optimization]
```cpp
class Fraction
{
private:
    int m_numerator;    // ë¶„ì
    int m_denominator;  // ë¶„ëª¨

public:
    Fraction(int num = 0, int den = 1)
        : m_numerator(num), m_denominator(den)
    {
        assert(den != 0);	
    }

    Fraction(const Fraction &fraction) // copy constructor
        : m_numerator(fraction.m_numerator), m_denominator(fraction.m_denominator)
    {
        cout << "Copy constructor called" << endl;
    }

    friend std::ostream & operator << (std::ostream &out, const Fraction &f)
    {
        out << f.m_numerator << " / " << f.m_denominator << endl;
        return out;
    }
};
```
* ì‚¬ìš©ì ì •ì˜ copy constructor ê°€ ì¡´ì¬í•˜ì§€ ì•Šì„ ê²½ìš° C++ ì€ public default copy constructor ë¥¼ ë§Œë“ ë‹¤.
* Copy constructor ë¥¼ private ìœ¼ë¡œ ì˜®ê¸°ë©´ copy constructor ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.
    * ì‚¬ìš©ì ì •ì˜ copy constructor ë¥¼ ë§Œë“  ê²ƒì´ê¸° ë•Œë¬¸ì— default copy constructor ë„ ì¡´ì¬í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ì»´íŒŒì¼ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.

#### ì‚¬ìš© ì˜ˆ

```cpp
Fraction frac(3, 5);
Fraction fr_copy(frac);
cout << frac << " " << fr_copy << endl;

// ì¶œë ¥
Copy constructor called
3 / 5
 3 / 5
```
* copy constructor ê°€ í˜¸ì¶œë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

```cpp
Fraction frac(3, 5);
Fraction fr_copy = frac;	
cout << frac << " " << fr_copy << endl;

// ì¶œë ¥
Copy constructor called
3 / 5
 3 / 5
```
* `Fraction fr_copy = frac;` copy initialization í•  ë•Œë„ copy constructor ê°€ ì‹¤í–‰ëœë‹¤.

```cpp
Fraction frac(3, 5);
Fraction fr_copy(Fraction(3, 10));	
cout << frac << " " << fr_copy << endl;

// ì¶œë ¥
3 / 5
 3 / 10
```
* `Fraction fr_copy(Fraction(3, 10));` Fraction(int, int) constructor ê°€ ì‹¤í–‰ë˜ê³  copy constructor ê°€ ì‹¤í–‰ë˜ëŠ” ê²ƒìœ¼ë¡œ ì˜ˆìƒí•œë‹¤.
    * í•˜ì§€ë§Œ ì»´íŒŒì¼ëŸ¬ê°€ copy constructor ë¥¼ ìƒëµí•˜ê³  `Fraction fr_copy(3, 10);` ë³€ê²½í•œë‹¤.   
        * ì´ ê³¼ì •ì„ copy elision ì´ë¼ í•œë‹¤.

#### RVO Return Value Optimization
RVO : ë¦¬í„´ ê°’ ìµœì í™”. ì»´íŒŒì¼ëŸ¬ê°€ ì•Œì•„ì„œ í•´ì¤€ë‹¤. 

```cpp
...

Fraction doSomething()
{
    Fraction temp(1, 2);
    cout << &temp << endl;
    return temp;
}

int main()
{
    Fraction result = doSomething();	
                                    
    cout << &result << endl;			
    cout << result << endl;			
}
```
___

```cpp
// Debug ëª¨ë“œë¡œ ì‹¤í–‰ì‹œ ì¶œë ¥
007EF860
Copy constructor called
007EF94C
1 / 2
```
* Debug ëª¨ë“œì¼ ë•ŒëŠ” ë‹¤ë¥¸ ì£¼ì†Œë¥¼ ê°–ê¸° ë•Œë¬¸ì— Copy constructor ê°€ ì‹¤í–‰ëœë‹¤.

```cpp
// Release ëª¨ë“œë¡œ ì‹¤í–‰ì‹œ ì¶œë ¥
006FFD54
006FFD54
1 / 2
```
* Release ëª¨ë“œì—ì„œëŠ” ì»´íŒŒì¼ëŸ¬ê°€ ìµœì í™”í•˜ê¸° ìœ„í•´ copy constructor ë¥¼ ì‹¤í–‰í•˜ì§€ ì•Šê²Œë” í•œë‹¤.
* Release ëª¨ë“œë¡œ ë°”ê¾¸ê³  ì‹¤í–‰í•˜ë©´ Copy constructor ë¡œ ë³µì‚¬í•˜ì§€ ì•Šê³  ë°”ë¡œ result ì— ë„£ì–´ì¤€ë‹¤.
* Release ëª¨ë“œì—ì„œëŠ” ì£¼ì†Œê°€ ê°™ê¸° ë•Œë¬¸ì— ë³µì‚¬ë¥¼ í•˜ì§€ ì•ŠëŠ”ë‹¤.



<pre>ë³¸ ë¸”ë¡œê·¸ëŠ” ê°œì¸ ê³µë¶€ ê¸°ë¡ì˜ ëª©ì ì„ ê°€ì§‘ë‹ˆë‹¤. í¬ìŠ¤íŠ¸ì˜ ë‚´ìš©ì€ ì–¸ì œë“ ì§€ ë°”ë€” ìˆ˜ ìˆìŠµë‹ˆë‹¤.</pre>{: .notice--info}